<!DOCTYPE HTML>
<html>
	<head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta property="og:title" content="CoverPick" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://r-aphus.github.io/coverpick/" />
        <meta property="og:image" content="https://r-aphus.github.io/coverpick/icon.png" />
        <meta property="og:site_name" content="CoverPick" />
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="https://r-aphus.github.io/coverpick/">
        <meta name="twitter:title" content="CoverPick">
        <meta name="twitter:image" content="https://r-aphus.github.io/coverpick/icon.png">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="default">
        <meta name="apple-mobile-web-app-title" content="CoverPick!">
        <link rel="apple-touch-icon" href="https://r-aphus.github.io/coverpick/icon.png" sizes="637Ã—518"/>
        <title>CoverPick</title>
        <style>
            body {
                margin: 0;
                padding: 0;
            }
            img {
                height: 25vw;
                width: 25vw;
            }
        </style>
	</head>
	<body>
        <div id="result"></div>
        <script>
            function API() {
                if (loading == false) {
                    loading = true;
                    var script = document.createElement('script');
                    script.setAttribute("type", "text/javascript");
                    script.setAttribute("src", "https://itunes.apple.com/search?term=album&media=music&entity=album&callback=callback&offset=" + Math.floor(Math.random() * 200) * 50);
                    document.body.appendChild(script);
                }
            }
            var loading = false;
            API();
            window.addEventListener('scroll', () => {
                let scrollTop = document.scrollingElement.scrollTop;
                if (scrollTop > (document.body.clientHeight - window.innerHeight * 1.5)) API();
            }, false);
            var div = document.getElementById("result");
            function callback(json) {
                for (var i in json.results) {
                    var img = document.createElement('img');
                    img.setAttribute("src", json.results[i].artworkUrl100);
                    img.setAttribute("onclick", "play('" + json.results[i].previewUrl + "')");
                    div.appendChild(img);
                }
                loading = false;
            }
            var audio = new Audio();
            var playing = "";
            function play(url) {
                audio.pause();
                if (playing == url) playing = "";
                else {
                    playing = url;
                    audio.src = url;
                    audio.play();
                }
            }
        </script>
    </body>
</html>